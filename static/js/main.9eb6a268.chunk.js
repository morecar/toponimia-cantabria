(this["webpackJsonptoponimia-cantabria"]=this["webpackJsonptoponimia-cantabria"]||[]).push([[0],{141:function(t,e){},265:function(t,e,s){},318:function(t,e){},320:function(t,e){},329:function(t,e){},331:function(t,e){},357:function(t,e){},358:function(t,e){},363:function(t,e){},365:function(t,e){},372:function(t,e){},391:function(t,e){},452:function(t,e,s){"use strict";s.r(e);var a=s(0),n=s.n(a),i=s(32),r=s.n(i),o=s(14),c=(s(265),s(259)),l=s(18),p=s(29),h=s(30),u=s(47),g=s(46),d=s(254),f=s(147),j=s(468),b=s(256),y=s(467),O=s(465),x=s(16),m=s(100),v={ast:"L'Unicurniu",esp:"L'Unicurniu"},T={ast:"Imagin de cabeza di unicurniu",esp:"Imagen de cabeza de unicornio"},k={ast:"B\xfasqueda con regexp\u2026",esp:"B\xfasqueda con regexp\u2026"},C=s(2),w=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).searchBar=n.a.createRef(),a.state={tags:[],rawQuery:"",searchString:a.props.searchBoxContents},a}return Object(h.a)(s,[{key:"handleSearch",value:function(t){t.preventDefault();var e=this.searchBar.current.value.trim();this.props.onSearch(e)}},{key:"handleChange",value:function(t){if(this.props.config.searchAutocompleteUnderdoth){var e=RegExp(/h\.\S/,"i");this.searchBar.current.value=this.searchBar.current.value.replace(e,(function(t,e,s){return t.startsWith("h")?"\u1e25".concat(s[e+2]):"\u1e24".concat([e+2])}))}}},{key:"render",value:function(){return Object(C.jsx)("div",{children:Object(C.jsx)(x.a,{inline:!0,onSubmit:this.handleSearch.bind(this),children:Object(C.jsx)(m.a,{type:"text",onChange:this.handleChange.bind(this),placeholder:k[this.props.config.language],ref:this.searchBar})})})}}]),s}(a.Component),S=s(31),_=s(148),B=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(){return Object(p.a)(this,s),e.apply(this,arguments)}return Object(h.a)(s,[{key:"handleToggleChanged",value:function(t){"show-title-always"===t.target.id&&t.target.checked&&(this.props.config.resultsTitle="always"),"show-title-search"===t.target.id&&t.target.checked&&(this.props.config.resultsTitle="search"),"show-title-never"===t.target.id&&t.target.checked&&(this.props.config.resultsTitle="never"),"show-tags-always"===t.target.id&&t.target.checked&&(this.props.config.resultsTags="always"),"show-tags-search"===t.target.id&&t.target.checked&&(this.props.config.resultsTags="search"),"show-tags-never"===t.target.id&&t.target.checked&&(this.props.config.resultsTags="never"),"toggle-points"===t.target.id&&(this.props.config.resultsTypes=t.target.checked?Array.from(new Set(this.props.config.resultsTypes).add("point")):this.props.config.resultsTypes.filter((function(t){return"point"!==t}))),"toggle-lines"===t.target.id&&(this.props.config.resultsTypes=t.target.checked?Array.from(new Set(this.props.config.resultsTypes).add("line")):this.props.config.resultsTypes.filter((function(t){return"line"!==t}))),"toggle-polygons"===t.target.id&&(this.props.config.resultsTypes=t.target.checked?Array.from(new Set(this.props.config.resultsTypes).add("poly")):this.props.config.resultsTypes.filter((function(t){return"poly"!==t}))),"toggle-underdoth"===t.target.id&&(this.props.config.searchAutocompleteUnderdoth=t.target.checked),"toggle-tag-auto"===t.target.id&&(this.props.config.searchAutocompleteTags=t.target.checked),"toggle-tag-palette"===t.target.id&&(this.props.config.searchDisplayTagPalette=t.target.checked),this.props.onSettingsUpdated()}},{key:"render",value:function(){var t=this.props,e=(t.pointRepository,t.searchBoxContents,t.onSettingsUpdated,Object(S.a)(t,["pointRepository","searchBoxContents","onSettingsUpdated"]));return Object(C.jsx)(_.a,Object(o.a)(Object(o.a)({},e),{},{onClick:function(t){},children:Object(C.jsx)(_.a.Content,{children:Object(C.jsxs)(x.a,{children:[Object(C.jsxs)(x.a.Group,{onChange:this.handleToggleChanged.bind(this),children:[Object(C.jsx)(x.a.Label,{children:Object(C.jsx)("b",{children:"Veyer tup\xfanimu"})}),Object(C.jsxs)("div",{children:[Object(C.jsx)(x.a.Check,{defaultChecked:"always"===this.props.config.resultsTitle,label:"Siempri",type:"radio",id:"show-title-always",name:"showTitle",disabled:!0}),Object(C.jsx)(x.a.Check,{defaultChecked:"search"===this.props.config.resultsTitle,label:"In b\xfasquedas",type:"radio",id:"show-title-search",name:"showTitle",disabled:!0}),Object(C.jsx)(x.a.Check,{defaultChecked:"never"===this.props.config.resultsTitle,label:"In cliquiandu",type:"radio",id:"show-title-never",name:"showTitle",disabled:!0})]})]}),Object(C.jsxs)(x.a.Group,{onChange:this.handleToggleChanged.bind(this),children:[Object(C.jsx)(x.a.Label,{children:Object(C.jsx)("b",{children:"Veyer etiquetas"})}),Object(C.jsxs)("div",{children:[Object(C.jsx)(x.a.Check,{defaultChecked:"always"===this.props.config.resultsTags,label:"Siempri",type:"radio",id:"show-tags-always",name:"showTags"}),Object(C.jsx)(x.a.Check,{defaultChecked:"search"===this.props.config.resultsTags,label:"In b\xfasquedas",type:"radio",id:"show-tags-search",name:"showTags"}),Object(C.jsx)(x.a.Check,{defaultChecked:"never"===this.props.config.resultsTags,label:"Desactiv\xe1s",type:"radio",id:"show-tags-never",name:"showTags"})]})]}),Object(C.jsxs)(x.a.Group,{onChange:this.handleToggleChanged.bind(this),children:[Object(C.jsx)(x.a.Label,{children:Object(C.jsx)("b",{children:"Clas de result\xe1us"})}),Object(C.jsxs)("div",{children:[Object(C.jsx)(x.a.Check,{inline:!0,defaultChecked:this.props.config.resultsTypes.includes("point"),label:"Puntualis",type:"checkbox",id:"toggle-points"}),Object(C.jsx)(x.a.Check,{inline:!0,defaultChecked:this.props.config.resultsTypes.includes("line"),label:"Linialis",type:"checkbox",id:"toggle-lines",disabled:!0}),Object(C.jsx)(x.a.Check,{inline:!0,defaultChecked:this.props.config.resultsTypes.includes("poly"),label:"Zonalis",type:"checkbox",id:"toggle-polygons",disabled:!0})]})]}),Object(C.jsxs)(x.a.Group,{onChange:this.handleToggleChanged.bind(this),children:[Object(C.jsx)(x.a.Label,{children:Object(C.jsx)("b",{children:"Otrus"})}),Object(C.jsx)(x.a.Check,{defaultChecked:this.props.config.searchAutocompleteUnderdoth,type:"switch",id:"toggle-underdoth",label:"Detectar hachi supunti\xe1 (h.\u2192\u1e25)"}),Object(C.jsx)(x.a.Check,{defaultChecked:this.props.config.searchAutocompleteTags,type:"switch",id:"toggle-tag-auto",label:"Autucompletar etiquetas",disabled:!0}),Object(C.jsx)(x.a.Check,{defaultChecked:this.props.config.searchDisplayTagPalette,type:"switch",id:"toggle-tag-palette",label:"Veyer paleta etiquetas",disabled:!0})]})]})})}))}}]),s}(a.Component),L=s(462),P=s(469),A=s(463),I=s(464),R=s(460),D=s(461),U=s(459),W=s(253);function z(t){return Object(C.jsx)(U.a,{permanent:!0,direction:"bottom",offset:[-15,20],className:"tagsContainer",children:Object.keys(t.tags).map((function(e){return Object(C.jsxs)("span",{children:[Object(C.jsx)(W.a,{variant:"primary",children:q(t.tags[e])})," "]},e)}))})}function q(t){if(t.startsWith("etymology")){if(t.endsWith("celtic"))return"Et: Celta";if(t.endsWith("romance"))return"Et: Romanci"}if(t.startsWith("phonology")){if(t.endsWith("metaphony_u"))return"Metafun\xeda U";if(t.endsWith("aspirate_f"))return"F aspir\xe1u";if(t.endsWith("b_g"))return"Cambiu B > G";if(t.endsWith("lost_f"))return"F mudu"}return t.split(":").pop()}function G(t){return Object(C.jsxs)(R.a,{position:t.position,children:[Object(C.jsx)(D.a,{children:t.title}),t.displayTags?Object(C.jsx)(z,{tags:t.tags}):null]})}var N=[43.19775063914452,-4.029390585676174];function J(t){return t.reduce((function(e,s){return[e[0]+s[0]/t.length,e[1]+s[1]/t.length]}),[0,0])}function E(t){var e={color:"black"};return Object(C.jsxs)(L.a,{center:N,zoom:10,scrollWheelZoom:!0,zoomControl:!1,dragging:!0,children:[Object(C.jsx)(P.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object.keys(t.points).map((function(e){return Object(C.jsx)(G,Object(o.a)({displayTags:t.displayTags,position:t.points[e].coordinates[0]},t.points[e]),e)})),Object.keys(t.polys).map((function(s){return Object(C.jsxs)("div",{children:[Object(C.jsx)(A.a,{pathOptions:e,positions:t.polys[s].coordinates}),Object(C.jsx)(G,Object(o.a)({displayTags:t.displayTags,position:J(t.polys[s].coordinates)},t.polys[s]),s)]},s)})),Object.keys(t.lines).map((function(s){return Object(C.jsxs)("div",{children:[Object(C.jsx)(I.a,{pathOptions:e,positions:t.lines[s].coordinates}),Object(C.jsx)(G,Object(o.a)({displayTags:t.displayTags,position:J(t.lines[s].coordinates)},t.lines[s]),s)]},s)}))]})}var F=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).state={search:!!a.props.searchBoxContents,displayTags:"always"===a.props.config.resultsTags||"search"===a.props.config.resultsTags&&a.props.searchBoxContents,displayLines:a.props.config.resultsTypes.includes("line"),displayPolys:a.props.config.resultsTypes.includes("poly"),displayPoints:a.props.config.resultsTypes.includes("point"),retultsToDisplay:a.props.pointRepository.search(a.props.searchBoxContents)},a}return Object(h.a)(s,[{key:"updateResults",value:function(t){console.log("searchstring=".concat(t," => search=").concat(!!t)),this.setState({search:!!t,displayTags:"always"===this.props.config.resultsTags||!("search"!==this.props.config.resultsTags||!t),retultsToDisplay:this.props.pointRepository.search(t,!1)})}},{key:"handleSettingsUpdated",value:function(){this.setState({displayTags:"always"===this.props.config.resultsTags||"search"===this.props.config.resultsTags&&this.state.search,displayLines:this.props.config.resultsTypes.includes("line"),displayPolys:this.props.config.resultsTypes.includes("poly"),displayPoints:this.props.config.resultsTypes.includes("point")})}},{key:"render",value:function(){var t=this.state.displayPoints?this.state.retultsToDisplay.filter((function(t){return"point"===t.type})):[],e=this.state.displayPolys?this.state.retultsToDisplay.filter((function(t){return"poly"===t.type})):[],s=this.state.displayLines?this.state.retultsToDisplay.filter((function(t){return"line"===t.type})):[];return Object(C.jsxs)(d.a,{children:[Object(C.jsxs)(f.a,{fixed:"top",bg:"dark",expand:"lg",variant:"dark",children:[Object(C.jsx)(f.a.Brand,{children:Object(C.jsx)("img",{src:"./unicorn.png",alt:T[this.props.config.language]})}),Object(C.jsx)(f.a.Brand,{className:"main-brand",children:v[this.props.config.language]}),Object(C.jsx)(f.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(C.jsx)(f.a.Collapse,{id:"basic-navbar-nav",children:Object(C.jsxs)(j.a,{className:"mr-auto",children:[Object(C.jsx)(w,Object(o.a)({onSearch:this.updateResults.bind(this),tags:this.props.pointRepository.getAllTags()},this.props)),Object(C.jsx)(b.a,{id:"settings",children:Object(C.jsx)(y.a,{trigger:"click",placement:"bottom",overlay:Object(C.jsx)(B,Object(o.a)({onSettingsUpdated:this.handleSettingsUpdated.bind(this)},this.props)),children:Object(C.jsx)(O.a,{style:{fontSize:"xx-large"}})})})]})})]}),Object(C.jsx)(E,Object(o.a)({points:t,lines:s,polys:e,displayTags:this.state.displayTags},this.props))]})}}]),s}(a.Component),X=s(260),M=s(466);function V(t){Object(M.a)({click:function(e){var s=e.latlng,a=s.lat,n=s.lng;t.onClick([a,n])}})}var Z=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).searchBoxRef=n.a.createRef(),a.state={newPoints:[]},a}return Object(h.a)(s,[{key:"registerLocation",value:function(t){this.setState({newPoints:[].concat(Object(X.a)(this.state.newPoints),[t])})}},{key:"render",value:function(){var t=this.state.newPoints.length-1;return Object(C.jsxs)(d.a,{children:[Object(C.jsxs)(L.a,{center:N,zoom:10,scrollWheelZoom:!0,zoomControl:!1,dragging:!0,children:[Object(C.jsx)(P.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object.keys(this.state.newPoints).map(function(t){return Object(C.jsx)(R.a,{position:this.state.newPoints[t]},t)}.bind(this)),Object(C.jsx)(I.a,{pathOptions:{color:"black"},positions:this.state.newPoints}),this.state.newPoints.length>2?Object(C.jsx)(I.a,{pathOptions:{color:"black",dashArray:"4"},positions:[this.state.newPoints[0],this.state.newPoints[t]]}):null,Object(C.jsx)(V,{onClick:this.registerLocation.bind(this)})]}),Object(C.jsx)(f.a,{fixed:"bottom",bg:"dark",expand:"lg",variant:"dark",children:Object(C.jsx)(f.a.Brand,{children:Object(C.jsx)("img",{src:"./unicorn.png",alt:"Icunu di unicurniu encabrit\xe1u"})})})]})}}]),s}(a.Component);function H(t){return Object(C.jsx)(c.a,{children:Object(C.jsxs)(l.c,{children:[Object(C.jsx)(l.a,{path:"/nuivu",children:Object(C.jsx)(Z,Object(o.a)({pointRepository:t.repository},t))}),Object(C.jsx)(l.a,{path:"/",children:Object(C.jsx)(F,Object(o.a)({pointRepository:t.repository,searchBoxContents:""},t))})]})})}var K=function(){function t(){Object(p.a)(this,t),this.localConfig=localStorage.getItem("config"),this.localConfig?this.localConfig=JSON.parse(this.localConfig):(this.localConfig=this.getDefaultConfig(),this.saveToLocalStorage())}return Object(h.a)(t,[{key:"getDefaultConfig",value:function(){return{lang:"ast",results_title:"never",results_tags:"search",results_types:["point"],search_autocomplete_underdoth:!0,search_autocomplete_tags:!1,search_display_tag_palette:!1}}},{key:"saveToLocalStorage",value:function(){localStorage.setItem("config",JSON.stringify(this.localConfig))}},{key:"language",get:function(){return this.localConfig.lang},set:function(t){this.localConfig.lang=t,this.saveToLocalStorage()}},{key:"resultsTitle",get:function(){return this.localConfig.results_title},set:function(t){this.localConfig.results_title=t,this.saveToLocalStorage()}},{key:"resultsTags",get:function(){return this.localConfig.results_tags},set:function(t){this.localConfig.results_tags=t,this.saveToLocalStorage()}},{key:"resultsTypes",get:function(){return this.localConfig.results_types},set:function(t){this.localConfig.results_types=t,this.saveToLocalStorage()}},{key:"searchAutocompleteUnderdoth",get:function(){return this.localConfig.search_autocomplete_underdoth},set:function(t){this.localConfig.search_autocomplete_underdoth=t,this.saveToLocalStorage()}},{key:"searchAutocompleteTags",get:function(){return this.localConfig.search_autocomplete_tags},set:function(t){this.localConfig.search_autocomplete_tags=t,this.saveToLocalStorage()}},{key:"searchDisplayTagPalette",get:function(){return this.localConfig.search_display_tag_palette},set:function(t){this.localConfig.search_display_tag_palette=t,this.saveToLocalStorage()}}]),t}(),Q=s(11),Y=s.n(Q),$=s(57),tt=s(68),et=s.n(tt),st=function(){function t(e){Object(p.a)(this,t),this.database=et()(e).orderBy(["title"])}return Object(h.a)(t,[{key:"search",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=e?this.preprocessPattern(t):t,a=RegExp(s,"i");return this.database.filter((function(t){return a.test(t.title)})).value()}},{key:"getAllTags",value:function(){var t=new Set;return this.database.map((function(t){return t.tags})).forEach((function(e){return t.add(e)})),Array.from(t)}},{key:"preprocessPattern",value:function(t){return t.replace("a","([\xe1a])").replace("e","([\xe9e])").replace("i","([\xedi])").replace("o","([\xf3o])").replace("u","([\xfau])")}}]),t}();function at(){return(at=Object($.a)(Y.a.mark((function t(e){return Y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(e.hash)&&rt(e.hash,e.sheet),t.abrupt("return",nt());case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function nt(){return it.apply(this,arguments)}function it(){return(it=Object($.a)(Y.a.mark((function t(){return Y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve(new st(JSON.parse(localStorage.getItem("localIndex")))));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function rt(t,e){return ot.apply(this,arguments)}function ot(){return(ot=Object($.a)(Y.a.mark((function t(e,s){return Y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.getRows().then((function(t){var s=t.map((function(t){return{title:t.name,type:t.type,coordinates:t.coordinates.trim().split(";").map((function(t){return t.trim().split(",").map(parseFloat)})),tags:t.tags.split(",")}}));localStorage.setItem("localIndex",JSON.stringify(s)),localStorage.setItem("localIndexHash",e),console.log("Database: updated to ".concat(e))}));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ct(t){var e=localStorage.getItem("localIndexHash"),s=t!==e;return console.log("Database: current is ".concat(e,", reload=").concat(s)),s}var lt=s(258),pt="AIzaSyBl_GJjcKmg4Lk0dWPLzGX6bXpT0vXW5R0",ht="A1",ut=new lt.GoogleSpreadsheet("1Rd8TQOp2hSBOxhSeAaLeb_faICF2_oAv2-jtn2vgXrY");function gt(){return(gt=Object($.a)(Y.a.mark((function t(){return Y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ut.useApiKey(pt);case 2:return t.abrupt("return",dt());case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function dt(){return ft.apply(this,arguments)}function ft(){return(ft=Object($.a)(Y.a.mark((function t(){var e;return Y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ut.loadInfo();case 2:return console.log("Spreadsheets: loaded document ".concat(ut.title)),t.next=5,ut.sheetsByTitle.INFO;case 5:return e=t.sent,t.next=8,e.loadCells("".concat(ht,":").concat(ht));case 8:return t.t0=e.getCellByA1(ht).value,t.next=11,ut.sheetsByTitle.DB;case 11:return t.t1=t.sent,t.abrupt("return",{hash:t.t0,sheet:t.t1});case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}(function(){return gt.apply(this,arguments)})().then((function(t){return at.apply(this,arguments)})).then((function(t){var e=new K;r.a.render(Object(C.jsx)(H,{config:e,repository:t}),document.getElementById("root"))}))}},[[452,1,2]]]);
//# sourceMappingURL=main.9eb6a268.chunk.js.map