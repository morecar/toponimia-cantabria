(this["webpackJsonptoponimia-cantabria"]=this["webpackJsonptoponimia-cantabria"]||[]).push([[0],{141:function(t,e){},310:function(t,e){},312:function(t,e){},321:function(t,e){},323:function(t,e){},349:function(t,e){},350:function(t,e){},355:function(t,e){},357:function(t,e){},364:function(t,e){},383:function(t,e){},444:function(t,e,s){},452:function(t,e,s){"use strict";s.r(e);var n=s(11),a=s.n(n),i=s(72),r=s(0),o=s.n(r),c=s(32),l=s.n(c),p=s(252),h="AIzaSyBl_GJjcKmg4Lk0dWPLzGX6bXpT0vXW5R0",u=s(29),g=s(30),d=s(66),f=s.n(d),j=function(){function t(e){Object(u.a)(this,t),this.database=f()(e).orderBy(["title"])}return Object(g.a)(t,[{key:"search",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=e?this.preprocessPattern(t):t,n=RegExp(s,"i");return this.database.filter((function(t){return n.test(t.title)})).value()}},{key:"getAllTags",value:function(){var t=new Set;return this.database.map((function(t){return t.tags})).forEach((function(e){return t.add(e)})),Array.from(t)}},{key:"preprocessPattern",value:function(t){return t.replace("a","([\xe1a])").replace("e","([\xe9e])").replace("i","([\xedi])").replace("o","([\xf3o])").replace("u","([\xfau])")}}]),t}();function b(){return(b=Object(i.a)(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",x(e)?y(e).then((function(t){return new j(t)})):Promise.resolve(new j(JSON.parse(localStorage.getItem("localIndex")))));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(t){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(a.a.mark((function t(e){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.rowCount,t.abrupt("return",e.getRows().then((function(t){var e=t.map((function(t){return{title:t.name,type:t.type,coordinates:t.coordinates.trim().split(";").map((function(t){return t.trim().split(",").map(parseFloat)})),tags:t.tags.split(",")}}));localStorage.setItem("localIndex",JSON.stringify(e)),localStorage.setItem("localIndexSize",s)})));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(t){var e=parseInt(localStorage.getItem("localIndexSize"))!==parseInt(t.rowCount);return console.log("Database: reload=".concat(e)),e}var m=s(14),v=(s(444),s(259)),k=s(18),T=s(47),C=s(46),w=s(255),S=s(147),_=s(468),P=s(257),B=s(467),I=s(465),L=s(16),A=s(100),R={ast:"L'Unicurniu",esp:"L'Unicurniu"},D={ast:"Imagin de cabeza di unicurniu",esp:"Imagen de cabeza de unicornio"},z={ast:"B\xfasqueda con regexp\u2026",esp:"B\xfasqueda con regexp\u2026"},U=s(2),W=function(t){Object(T.a)(s,t);var e=Object(C.a)(s);function s(t){var n;return Object(u.a)(this,s),(n=e.call(this,t)).searchBar=o.a.createRef(),n.state={tags:[],rawQuery:"",searchString:n.props.searchBoxContents},n}return Object(g.a)(s,[{key:"handleSearch",value:function(t){t.preventDefault();var e=this.searchBar.current.value.trim();this.props.onSearch(e)}},{key:"handleChange",value:function(t){if(this.props.config.searchAutocompleteUnderdoth){var e=RegExp(/h\.\S/,"i");this.searchBar.current.value=this.searchBar.current.value.replace(e,(function(t,e,s){return t.startsWith("h")?"\u1e25".concat(s[e+2]):"\u1e24".concat([e+2])}))}}},{key:"render",value:function(){return Object(U.jsx)("div",{children:Object(U.jsx)(L.a,{inline:!0,onSubmit:this.handleSearch.bind(this),children:Object(U.jsx)(A.a,{type:"text",onChange:this.handleChange.bind(this),placeholder:z[this.props.config.language],ref:this.searchBar})})})}}]),s}(r.Component),q=s(31),G=s(148),J=function(t){Object(T.a)(s,t);var e=Object(C.a)(s);function s(){return Object(u.a)(this,s),e.apply(this,arguments)}return Object(g.a)(s,[{key:"handleToggleChanged",value:function(t){"show-title-always"===t.target.id&&t.target.checked&&(this.props.config.resultsTitle="always"),"show-title-search"===t.target.id&&t.target.checked&&(this.props.config.resultsTitle="search"),"show-title-never"===t.target.id&&t.target.checked&&(this.props.config.resultsTitle="never"),"show-tags-always"===t.target.id&&t.target.checked&&(this.props.config.resultsTags="always"),"show-tags-search"===t.target.id&&t.target.checked&&(this.props.config.resultsTags="search"),"show-tags-never"===t.target.id&&t.target.checked&&(this.props.config.resultsTags="never"),"toggle-points"===t.target.id&&(this.props.config.resultsTypes=t.target.checked?Array.from(new Set(this.props.config.resultsTypes).add("point")):this.props.config.resultsTypes.filter((function(t){return"point"!==t}))),"toggle-lines"===t.target.id&&(this.props.config.resultsTypes=t.target.checked?Array.from(new Set(this.props.config.resultsTypes).add("line")):this.props.config.resultsTypes.filter((function(t){return"line"!==t}))),"toggle-polygons"===t.target.id&&(this.props.config.resultsTypes=t.target.checked?Array.from(new Set(this.props.config.resultsTypes).add("poly")):this.props.config.resultsTypes.filter((function(t){return"poly"!==t}))),"toggle-underdoth"===t.target.id&&(this.props.config.searchAutocompleteUnderdoth=t.target.checked),"toggle-tag-auto"===t.target.id&&(this.props.config.searchAutocompleteTags=t.target.checked),"toggle-tag-palette"===t.target.id&&(this.props.config.searchDisplayTagPalette=t.target.checked),this.props.onSettingsUpdated()}},{key:"render",value:function(){var t=this.props,e=(t.pointRepository,t.searchBoxContents,t.onSettingsUpdated,Object(q.a)(t,["pointRepository","searchBoxContents","onSettingsUpdated"]));return Object(U.jsx)(G.a,Object(m.a)(Object(m.a)({},e),{},{onClick:function(t){},children:Object(U.jsx)(G.a.Content,{children:Object(U.jsxs)(L.a,{children:[Object(U.jsxs)(L.a.Group,{onChange:this.handleToggleChanged.bind(this),children:[Object(U.jsx)(L.a.Label,{children:Object(U.jsx)("b",{children:"Veyer tup\xfanimu"})}),Object(U.jsxs)("div",{children:[Object(U.jsx)(L.a.Check,{defaultChecked:"always"===this.props.config.resultsTitle,label:"Siempri",type:"radio",id:"show-title-always",name:"showTitle",disabled:!0}),Object(U.jsx)(L.a.Check,{defaultChecked:"search"===this.props.config.resultsTitle,label:"In b\xfasquedas",type:"radio",id:"show-title-search",name:"showTitle",disabled:!0}),Object(U.jsx)(L.a.Check,{defaultChecked:"never"===this.props.config.resultsTitle,label:"In cliquiandu",type:"radio",id:"show-title-never",name:"showTitle",disabled:!0})]})]}),Object(U.jsxs)(L.a.Group,{onChange:this.handleToggleChanged.bind(this),children:[Object(U.jsx)(L.a.Label,{children:Object(U.jsx)("b",{children:"Veyer etiquetas"})}),Object(U.jsxs)("div",{children:[Object(U.jsx)(L.a.Check,{defaultChecked:"always"===this.props.config.resultsTags,label:"Siempri",type:"radio",id:"show-tags-always",name:"showTags"}),Object(U.jsx)(L.a.Check,{defaultChecked:"search"===this.props.config.resultsTags,label:"In b\xfasquedas",type:"radio",id:"show-tags-search",name:"showTags"}),Object(U.jsx)(L.a.Check,{defaultChecked:"never"===this.props.config.resultsTags,label:"Desactiv\xe1s",type:"radio",id:"show-tags-never",name:"showTags"})]})]}),Object(U.jsxs)(L.a.Group,{onChange:this.handleToggleChanged.bind(this),children:[Object(U.jsx)(L.a.Label,{children:Object(U.jsx)("b",{children:"Clas de result\xe1us"})}),Object(U.jsxs)("div",{children:[Object(U.jsx)(L.a.Check,{inline:!0,defaultChecked:this.props.config.resultsTypes.includes("point"),label:"Puntualis",type:"checkbox",id:"toggle-points"}),Object(U.jsx)(L.a.Check,{inline:!0,defaultChecked:this.props.config.resultsTypes.includes("line"),label:"Linialis",type:"checkbox",id:"toggle-lines",disabled:!0}),Object(U.jsx)(L.a.Check,{inline:!0,defaultChecked:this.props.config.resultsTypes.includes("poly"),label:"Zonalis",type:"checkbox",id:"toggle-polygons",disabled:!0})]})]}),Object(U.jsxs)(L.a.Group,{onChange:this.handleToggleChanged.bind(this),children:[Object(U.jsx)(L.a.Label,{children:Object(U.jsx)("b",{children:"Otrus"})}),Object(U.jsx)(L.a.Check,{defaultChecked:this.props.config.searchAutocompleteUnderdoth,type:"switch",id:"toggle-underdoth",label:"Detectar hachi supunti\xe1 (h.\u2192\u1e25)"}),Object(U.jsx)(L.a.Check,{defaultChecked:this.props.config.searchAutocompleteTags,type:"switch",id:"toggle-tag-auto",label:"Autucompletar etiquetas",disabled:!0}),Object(U.jsx)(L.a.Check,{defaultChecked:this.props.config.searchDisplayTagPalette,type:"switch",id:"toggle-tag-palette",label:"Veyer paleta etiquetas",disabled:!0})]})]})})}))}}]),s}(r.Component),N=s(462),E=s(469),F=s(463),X=s(464),M=s(460),V=s(461),Z=s(459),K=s(254);function Q(t){return Object(U.jsx)(Z.a,{permanent:!0,direction:"bottom",offset:[-15,20],className:"tagsContainer",children:Object.keys(t.tags).map((function(e){return Object(U.jsxs)("span",{children:[Object(U.jsx)(K.a,{variant:"primary",children:Y(t.tags[e])})," "]},e)}))})}function Y(t){if(t.startsWith("etymology")){if(t.endsWith("celtic"))return"Et: Celta";if(t.endsWith("romance"))return"Et: Romanci"}if(t.startsWith("phonology")){if(t.endsWith("metaphony_u"))return"Metafun\xeda U";if(t.endsWith("aspirate_f"))return"F aspir\xe1u";if(t.endsWith("b_g"))return"Cambiu B > G";if(t.endsWith("lost_f"))return"F mudu"}return t.split(":").pop()}function H(t){return Object(U.jsxs)(M.a,{position:t.position,children:[Object(U.jsx)(V.a,{children:t.title}),t.displayTags?Object(U.jsx)(Q,{tags:t.tags}):null]})}var $=[43.19775063914452,-4.029390585676174];function tt(t){return t.reduce((function(e,s){return[e[0]+s[0]/t.length,e[1]+s[1]/t.length]}),[0,0])}function et(t){var e={color:"black"};return Object(U.jsxs)(N.a,{center:$,zoom:10,scrollWheelZoom:!0,zoomControl:!1,dragging:!0,children:[Object(U.jsx)(E.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object.keys(t.points).map((function(e){return Object(U.jsx)(H,Object(m.a)({displayTags:t.displayTags,position:t.points[e].coordinates[0]},t.points[e]),e)})),Object.keys(t.polys).map((function(s){return Object(U.jsxs)("div",{children:[Object(U.jsx)(F.a,{pathOptions:e,positions:t.polys[s].coordinates}),Object(U.jsx)(H,Object(m.a)({displayTags:t.displayTags,position:tt(t.polys[s].coordinates)},t.polys[s]),s)]},s)})),Object.keys(t.lines).map((function(s){return Object(U.jsxs)("div",{children:[Object(U.jsx)(X.a,{pathOptions:e,positions:t.lines[s].coordinates}),Object(U.jsx)(H,Object(m.a)({displayTags:t.displayTags,position:tt(t.lines[s].coordinates)},t.lines[s]),s)]},s)}))]})}var st=function(t){Object(T.a)(s,t);var e=Object(C.a)(s);function s(t){var n;return Object(u.a)(this,s),(n=e.call(this,t)).state={search:!!n.props.searchBoxContents,displayTags:"always"===n.props.config.resultsTags||"search"===n.props.config.resultsTags&&n.props.searchBoxContents,displayLines:n.props.config.resultsTypes.includes("line"),displayPolys:n.props.config.resultsTypes.includes("poly"),displayPoints:n.props.config.resultsTypes.includes("point"),retultsToDisplay:n.props.pointRepository.search(n.props.searchBoxContents)},n}return Object(g.a)(s,[{key:"updateResults",value:function(t){console.log("searchstring=".concat(t," => search=").concat(!!t)),this.setState({search:!!t,displayTags:"always"===this.props.config.resultsTags||!("search"!==this.props.config.resultsTags||!t),retultsToDisplay:this.props.pointRepository.search(t,!1)})}},{key:"handleSettingsUpdated",value:function(){this.setState({displayTags:"always"===this.props.config.resultsTags||"search"===this.props.config.resultsTags&&this.state.search,displayLines:this.props.config.resultsTypes.includes("line"),displayPolys:this.props.config.resultsTypes.includes("poly"),displayPoints:this.props.config.resultsTypes.includes("point")})}},{key:"render",value:function(){var t=this.state.displayPoints?this.state.retultsToDisplay.filter((function(t){return"point"===t.type})):[],e=this.state.displayPolys?this.state.retultsToDisplay.filter((function(t){return"poly"===t.type})):[],s=this.state.displayLines?this.state.retultsToDisplay.filter((function(t){return"line"===t.type})):[];return Object(U.jsxs)(w.a,{children:[Object(U.jsxs)(S.a,{fixed:"top",bg:"dark",expand:"lg",variant:"dark",children:[Object(U.jsx)(S.a.Brand,{children:Object(U.jsx)("img",{src:"./unicorn.png",alt:D[this.props.config.language]})}),Object(U.jsx)(S.a.Collapse,{id:"basic-navbar-nav",children:Object(U.jsxs)(_.a,{className:"mr-auto",children:[Object(U.jsx)(S.a.Brand,{className:"main-brand",children:R[this.props.config.language]}),Object(U.jsx)(W,Object(m.a)({onSearch:this.updateResults.bind(this),tags:this.props.pointRepository.getAllTags()},this.props)),Object(U.jsx)(P.a,{id:"settings",children:Object(U.jsx)(B.a,{trigger:"click",placement:"bottom",overlay:Object(U.jsx)(J,Object(m.a)({onSettingsUpdated:this.handleSettingsUpdated.bind(this)},this.props)),children:Object(U.jsx)(I.a,{style:{fontSize:"xx-large"}})})})]})})]}),Object(U.jsx)(et,Object(m.a)({points:t,lines:s,polys:e,displayTags:this.state.displayTags},this.props))]})}}]),s}(r.Component),nt=s(260),at=s(466);function it(t){Object(at.a)({click:function(e){var s=e.latlng,n=s.lat,a=s.lng;t.onClick([n,a])}})}var rt=function(t){Object(T.a)(s,t);var e=Object(C.a)(s);function s(t){var n;return Object(u.a)(this,s),(n=e.call(this,t)).searchBoxRef=o.a.createRef(),n.state={newPoints:[]},n}return Object(g.a)(s,[{key:"registerLocation",value:function(t){this.setState({newPoints:[].concat(Object(nt.a)(this.state.newPoints),[t])})}},{key:"render",value:function(){var t=this.state.newPoints.length-1;return Object(U.jsxs)(w.a,{children:[Object(U.jsxs)(N.a,{center:$,zoom:10,scrollWheelZoom:!0,zoomControl:!1,dragging:!0,children:[Object(U.jsx)(E.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object.keys(this.state.newPoints).map(function(t){return Object(U.jsx)(M.a,{position:this.state.newPoints[t]},t)}.bind(this)),Object(U.jsx)(X.a,{pathOptions:{color:"black"},positions:this.state.newPoints}),this.state.newPoints.length>2?Object(U.jsx)(X.a,{pathOptions:{color:"black",dashArray:"4"},positions:[this.state.newPoints[0],this.state.newPoints[t]]}):null,Object(U.jsx)(it,{onClick:this.registerLocation.bind(this)})]}),Object(U.jsx)(S.a,{fixed:"bottom",bg:"dark",expand:"lg",variant:"dark",children:Object(U.jsx)(S.a.Brand,{children:Object(U.jsx)("img",{src:"./unicorn.png",alt:"Icunu di unicurniu encabrit\xe1u"})})})]})}}]),s}(r.Component);function ot(t){return Object(U.jsx)(v.a,{children:Object(U.jsxs)(k.c,{children:[Object(U.jsx)(k.a,{path:"/nuivu",children:Object(U.jsx)(rt,Object(m.a)({pointRepository:t.repository},t))}),Object(U.jsx)(k.a,{path:"/",children:Object(U.jsx)(st,Object(m.a)({pointRepository:t.repository,searchBoxContents:""},t))})]})})}var ct=function(){function t(){Object(u.a)(this,t),this.localConfig=localStorage.getItem("config"),this.localConfig?this.localConfig=JSON.parse(this.localConfig):(this.localConfig=this.getDefaultConfig(),this.saveToLocalStorage())}return Object(g.a)(t,[{key:"getDefaultConfig",value:function(){return{lang:"ast",results_title:"never",results_tags:"search",results_types:["point"],search_autocomplete_underdoth:!0,search_autocomplete_tags:!1,search_display_tag_palette:!1}}},{key:"saveToLocalStorage",value:function(){localStorage.setItem("config",JSON.stringify(this.localConfig))}},{key:"language",get:function(){return this.localConfig.lang},set:function(t){this.localConfig.lang=t,this.saveToLocalStorage()}},{key:"resultsTitle",get:function(){return this.localConfig.results_title},set:function(t){this.localConfig.results_title=t,this.saveToLocalStorage()}},{key:"resultsTags",get:function(){return this.localConfig.results_tags},set:function(t){this.localConfig.results_tags=t,this.saveToLocalStorage()}},{key:"resultsTypes",get:function(){return this.localConfig.results_types},set:function(t){this.localConfig.results_types=t,this.saveToLocalStorage()}},{key:"searchAutocompleteUnderdoth",get:function(){return this.localConfig.search_autocomplete_underdoth},set:function(t){this.localConfig.search_autocomplete_underdoth=t,this.saveToLocalStorage()}},{key:"searchAutocompleteTags",get:function(){return this.localConfig.search_autocomplete_tags},set:function(t){this.localConfig.search_autocomplete_tags=t,this.saveToLocalStorage()}},{key:"searchDisplayTagPalette",get:function(){return this.localConfig.search_display_tag_palette},set:function(t){this.localConfig.search_display_tag_palette=t,this.saveToLocalStorage()}}]),t}(),lt=new p.GoogleSpreadsheet("1Rd8TQOp2hSBOxhSeAaLeb_faICF2_oAv2-jtn2vgXrY");function pt(){return(pt=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,lt.useApiKey(h);case 2:console.log("Authentication: API key");case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ht(){return(ht=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,lt.loadInfo();case 2:return console.log("Datasource: loaded document ".concat(lt.title)),t.next=5,lt.sheetsById[0];case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}(function(){return pt.apply(this,arguments)})().then(function(){return ht.apply(this,arguments)}().then((function(t){return function(t){return b.apply(this,arguments)}(t)})).then((function(t){return function(t){var e=new ct;l.a.render(Object(U.jsx)(ot,{config:e,repository:t}),document.getElementById("root"))}(t)})))}},[[452,1,2]]]);
//# sourceMappingURL=main.95197b13.chunk.js.map